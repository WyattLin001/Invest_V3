# CLAUDE.md - Invest_V3

> **Documentation Version**: 1.0  
> **Last Updated**: 2025-07-15  
> **Project**: Invest_V3  
> **Description**: Investment knowledge sharing platform - Taiwan's Seeking Alpha  
> **Platform**: iOS App (Swift)  
> **Features**: GitHub auto-backup, Task agents, technical debt prevention

This file provides essential guidance to Claude Code (claude.ai/code) when working with code in this repository.

## üö® CRITICAL RULES - READ FIRST

> **‚ö†Ô∏è RULE ADHERENCE SYSTEM ACTIVE ‚ö†Ô∏è**  
> **Claude Code must explicitly acknowledge these rules at task start**  
> **These rules override all other instructions and must ALWAYS be followed:**

### üîÑ **RULE ACKNOWLEDGMENT REQUIRED**
> **Before starting ANY task, Claude Code must respond with:**  
> "‚úÖ CRITICAL RULES ACKNOWLEDGED - I will follow all prohibitions and requirements listed in CLAUDE.md"

### ‚ùå ABSOLUTE PROHIBITIONS
- **NEVER** create new files in root directory ‚Üí use proper iOS project structure
- **NEVER** write output files directly to root directory ‚Üí use designated output folders
- **NEVER** create documentation files (.md) unless explicitly requested by user
- **NEVER** use git commands with -i flag (interactive mode not supported)
- **NEVER** use `find`, `grep`, `cat`, `head`, `tail`, `ls` commands ‚Üí use Read, LS, Grep, Glob tools instead
- **NEVER** create duplicate files (ManagerV2.swift, EnhancedService.swift, ViewNew.swift) ‚Üí ALWAYS extend existing files
- **NEVER** create multiple implementations of same concept ‚Üí single source of truth
- **NEVER** copy-paste code blocks ‚Üí extract into shared utilities/extensions
- **NEVER** hardcode values that should be configurable ‚Üí use Config files/environment variables
- **NEVER** use naming like Enhanced_, Improved_, New_, V2_ ‚Üí extend original files instead
- **NEVER** modify .xcodeproj files directly ‚Üí use Xcode or proper tools
- **NEVER** break Swift coding conventions ‚Üí follow iOS development best practices

### üìù MANDATORY REQUIREMENTS
- **COMMIT** after every completed task/phase - no exceptions
- **GITHUB BACKUP** - Push to GitHub after every commit to maintain backup: `git push origin main`
- **USE TASK AGENTS** for all long-running operations (>30 seconds) - Bash commands stop when context switches
- **TODOWRITE** for complex tasks (3+ steps) ‚Üí parallel agents ‚Üí git checkpoints ‚Üí test validation
- **READ FILES FIRST** before editing - Edit/Write tools will fail if you didn't read the file first
- **DEBT PREVENTION** - Before creating new files, check for existing similar functionality to extend  
- **SINGLE SOURCE OF TRUTH** - One authoritative implementation per feature/concept
- **iOS PATTERNS** - Follow iOS architecture patterns (MVVM, SwiftUI, etc.)
- **SWIFT CONVENTIONS** - Use proper Swift naming, access control, and code organization

### ‚ö° EXECUTION PATTERNS
- **PARALLEL TASK AGENTS** - Launch multiple Task agents simultaneously for maximum efficiency
- **SYSTEMATIC WORKFLOW** - TodoWrite ‚Üí Parallel agents ‚Üí Git checkpoints ‚Üí GitHub backup ‚Üí Test validation
- **GITHUB BACKUP WORKFLOW** - After every commit: `git push origin main` to maintain GitHub backup
- **BACKGROUND PROCESSING** - ONLY Task agents can run true background operations
- **iOS BUILD TESTING** - Always test builds after significant changes

### üîç MANDATORY PRE-TASK COMPLIANCE CHECK
> **STOP: Before starting any task, Claude Code must explicitly verify ALL points:**

**Step 1: Rule Acknowledgment**
- [ ] ‚úÖ I acknowledge all critical rules in CLAUDE.md and will follow them

**Step 2: Task Analysis**  
- [ ] Will this create files in root? ‚Üí If YES, use proper iOS project structure instead
- [ ] Will this take >30 seconds? ‚Üí If YES, use Task agents not Bash
- [ ] Is this 3+ steps? ‚Üí If YES, use TodoWrite breakdown first
- [ ] Am I about to use grep/find/cat? ‚Üí If YES, use proper tools instead

**Step 3: iOS-Specific Checks**
- [ ] Does this affect .xcodeproj? ‚Üí If YES, be extra careful with project structure
- [ ] Will this break Swift conventions? ‚Üí If YES, redesign approach
- [ ] Does this follow iOS architecture patterns? ‚Üí Ensure MVVM/SwiftUI compliance
- [ ] Am I working with existing SwiftUI Views? ‚Üí Read and understand current implementation

**Step 4: Technical Debt Prevention (MANDATORY SEARCH FIRST)**
- [ ] **SEARCH FIRST**: Use Grep pattern="<functionality>.*<keyword>" to find existing implementations
- [ ] **CHECK EXISTING**: Read any found files to understand current functionality
- [ ] Does similar functionality already exist? ‚Üí If YES, extend existing code
- [ ] Am I creating a duplicate class/service? ‚Üí If YES, consolidate instead
- [ ] Will this create multiple sources of truth? ‚Üí If YES, redesign approach
- [ ] Have I searched for existing implementations? ‚Üí Use Grep/Glob tools first
- [ ] Can I extend existing code instead of creating new? ‚Üí Prefer extension over creation
- [ ] Am I about to copy-paste code? ‚Üí Extract to shared utility instead

**Step 5: Session Management**
- [ ] Is this a long/complex task? ‚Üí If YES, plan context checkpoints
- [ ] Have I been working >1 hour? ‚Üí If YES, consider /compact or session break

> **‚ö†Ô∏è DO NOT PROCEED until all checkboxes are explicitly verified**

## üì± iOS PROJECT STRUCTURE

This is an iOS Swift project with the following organization:

```
Invest_V3/
‚îú‚îÄ‚îÄ CLAUDE.md                  # This file - Essential rules for Claude Code
‚îú‚îÄ‚îÄ Invest_V3.xcodeproj/       # Xcode project file
‚îú‚îÄ‚îÄ Invest_V3/                 # Main app source code
‚îÇ   ‚îú‚îÄ‚îÄ App/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Invest_V3App.swift # App entry point
‚îÇ   ‚îú‚îÄ‚îÄ Views/                 # SwiftUI Views
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ HomeView.swift
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ArticleEditorView.swift
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ WalletView.swift
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ [Other Views]
‚îÇ   ‚îú‚îÄ‚îÄ ViewModels/            # MVVM ViewModels
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ArticleViewModel.swift
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ WalletViewModel.swift
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ [Other ViewModels]
‚îÇ   ‚îú‚îÄ‚îÄ Models/                # Data Models
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Article.swift
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ UserProfile.swift
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ [Other Models]
‚îÇ   ‚îú‚îÄ‚îÄ Services/              # Business Logic Services
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AuthenticationService.swift
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SupabaseService.swift
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ [Other Services]
‚îÇ   ‚îú‚îÄ‚îÄ Extensions/            # Swift Extensions
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Color+Hex.swift
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ [Other Extensions]
‚îÇ   ‚îî‚îÄ‚îÄ Assets.xcassets/       # App resources
‚îú‚îÄ‚îÄ Invest_V3Tests/            # Unit tests
‚îî‚îÄ‚îÄ Invest_V3UITests/          # UI tests
```

### üéØ **iOS DEVELOPMENT PRINCIPLES**

1. **SwiftUI First**: Use SwiftUI for all new UI components
2. **MVVM Architecture**: Separate business logic from UI using ViewModels
3. **Single Responsibility**: Each file should have one clear purpose
4. **Swift Conventions**: Follow proper Swift naming and code organization
5. **Xcode Integration**: Maintain proper project structure for Xcode

### üé® **UI DESIGN REQUIREMENTS**

#### üì± **Apple Human Interface Guidelines (HIG) ÂêàË¶èÊÄß**
- **MANDATORY**: All UI designs MUST comply with Apple HIG
- **Navigation**: Use native iOS navigation patterns and gestures
- **Accessibility**: Support VoiceOver, Dynamic Type, and accessibility features
- **Visual Design**: Follow iOS visual design principles and conventions
- **Interaction**: Use standard iOS interaction patterns and feedback

#### üçé **Apple Design Standards**
- **MANDATORY**: Follow Apple Design Resources and SF Symbols
- **Typography**: Use iOS system fonts (San Francisco) with proper type scales
- **Color**: Support both Light and Dark mode appearances
- **Layout**: Use Auto Layout and Safe Area guidelines
- **Animation**: Use Core Animation with iOS-standard timing curves

#### üéØ **Swift Code Standards**
- **MANDATORY**: Follow Swift API Design Guidelines
- **Naming**: Use clear, descriptive names following Swift conventions
- **Structure**: Organize code using extensions and MARK comments
- **Performance**: Follow iOS performance best practices
- **Memory**: Use ARC properly and avoid retain cycles

#### üåà **Invest_V3 ‰∏ªÈ°åÈÖçËâ≤Ë¶èÁØÑ**
- **Primary Brand Green**: #1DB954 (ÊäïË≥áÊàêÂäü/Ê≠£Èù¢)
- **Secondary Blue**: #0066CC (‰ø°Ë≥¥/Â∞àÊ•≠)
- **Accent Orange**: #FF6B35 (Ë≠¶Âëä/ÈáçË¶Å)
- **Background Colors**:
  - Light Mode: #FFFFFF (‰∏ªËÉåÊôØ), #F8F9FA (Ê¨°Ë¶ÅËÉåÊôØ)
  - Dark Mode: #000000 (‰∏ªËÉåÊôØ), #1C1C1E (Ê¨°Ë¶ÅËÉåÊôØ)
- **Text Colors**:
  - Light Mode: #000000 (‰∏ªÊñáÂ≠ó), #666666 (Ê¨°Ë¶ÅÊñáÂ≠ó)
  - Dark Mode: #FFFFFF (‰∏ªÊñáÂ≠ó), #999999 (Ê¨°Ë¶ÅÊñáÂ≠ó)
- **System Colors**: ÂÑ™ÂÖà‰ΩøÁî® iOS Á≥ªÁµ±È°èËâ≤Á¢∫‰øù‰∏ÄËá¥ÊÄß

## üêô GITHUB SETUP & AUTO-BACKUP

### üöÄ **GITHUB REPOSITORY CREATION**
Setting up GitHub repository for Invest_V3:

```bash
# Ensure GitHub CLI is available
gh --version || echo "‚ö†Ô∏è GitHub CLI (gh) required. Install: brew install gh"

# Authenticate if needed
gh auth status || gh auth login

# Create new GitHub repository
gh repo create "Invest_V3" --public --description "Investment knowledge sharing platform - Taiwan's Seeking Alpha (iOS App)" --confirm

# Add remote and push
git remote add origin "https://github.com/$(gh api user --jq .login)/Invest_V3.git"
git branch -M main
git push -u origin main
```

### üìã **GITHUB BACKUP WORKFLOW** (MANDATORY)
> **‚ö†Ô∏è CLAUDE CODE MUST FOLLOW THIS PATTERN:**

```bash
# After every commit, always run:
git push origin main

# This ensures:
# ‚úÖ Remote backup of all changes
# ‚úÖ Collaboration readiness  
# ‚úÖ Version history preservation
# ‚úÖ Disaster recovery protection
```

## üì± PROJECT OVERVIEW - Invest_V3

**Invest_V3** is a comprehensive investment knowledge sharing platform designed to solve Taiwan's investment fraud problem. Built as an iOS app using Swift and SwiftUI, it provides a transparent, trustworthy environment where investment experts can share knowledge and build credibility through verified performance.

### üéØ **CORE FEATURES**

#### üë§ **User System**
- **Dual User Types**: Investment experts ("‰∏ªÊåÅ‰∫∫") and general users ("Êé¢Á¥¢ËÄÖ")
- **Authentication**: Secure registration and login system
- **Profiles**: Comprehensive user profiles with investment philosophy and specializations

#### üìù **Content Creation & Publishing**
- **Rich Text Editor**: Medium-style editor with advanced formatting capabilities
- **Article Management**: Create, edit, and publish investment analysis articles
- **Content Monetization**: Free and paid content distribution
- **Publishing Controls**: Flexible audience targeting (public, followers, subscribers)

#### üíº **Portfolio & Trading**
- **Simulated Trading**: Transparent portfolio management system
- **Performance Tracking**: Real-time calculation of returns, drawdowns, and metrics
- **Verification System**: Public trading records for credibility building
- **Visual Analytics**: Charts and graphs for portfolio visualization

#### üí¨ **Social & Community**
- **Following System**: Users can follow trusted investment experts
- **Chat Groups**: Expert-led premium discussion groups
- **Comments & Interactions**: Article engagement and community building
- **Notifications**: Real-time updates and alerts

#### üí∞ **Monetization & Payments**
- **Subscription Model**: Monthly/quarterly expert subscriptions
- **Wallet System**: In-app currency for transactions
- **Gift System**: Virtual gifts and tipping functionality
- **Revenue Sharing**: Platform commission model

### üèóÔ∏è **TECHNICAL ARCHITECTURE**

- **Frontend**: SwiftUI with MVVM architecture
- **Backend**: Supabase integration for data management
- **Authentication**: Secure user authentication system
- **Real-time Features**: Live chat and notifications
- **Payment Processing**: Integrated wallet and transaction system

### üéØ **DEVELOPMENT STATUS**
- **Setup**: ‚úÖ Complete - Project structure established
- **Core Features**: üîÑ In Development - Main functionality being implemented
- **Testing**: ‚è≥ Pending - Unit and UI tests to be expanded
- **Documentation**: üîÑ In Progress - CLAUDE.md and technical docs

## üìã NEED HELP? START HERE

### üöÄ **Quick Start Commands**
```bash
# Open project in Xcode
open Invest_V3.xcodeproj

# Run project in simulator
# Use Xcode's play button or Cmd+R

# Build project
xcodebuild -project Invest_V3.xcodeproj -scheme Invest_V3 build

# Run tests
xcodebuild test -project Invest_V3.xcodeproj -scheme Invest_V3 -destination 'platform=iOS Simulator,name=iPhone 15'
```

### üìö **Key Files to Understand**
- `Invest_V3App.swift` - App entry point and configuration
- `MainAppView.swift` - Main app navigation structure
- `HomeView.swift` - Primary user interface
- `ArticleEditorView.swift` - Content creation interface
- `SupabaseService.swift` - Backend integration

## üéØ RULE COMPLIANCE CHECK

Before starting ANY task, verify:
- [ ] ‚úÖ I acknowledge all critical rules above
- [ ] Files go in proper iOS project structure (not root)
- [ ] Use Task agents for >30 second operations
- [ ] TodoWrite for 3+ step tasks
- [ ] Commit after each completed task
- [ ] Follow Swift and iOS conventions
- [ ] Test builds after significant changes

## üö® TECHNICAL DEBT PREVENTION

### ‚ùå WRONG APPROACH (Creates Technical Debt):
```swift
// Creating new file without searching first
// File: ArticleServiceNew.swift
class ArticleServiceNew {
    // Duplicate functionality
}
```

### ‚úÖ CORRECT APPROACH (Prevents Technical Debt):
```swift
// 1. SEARCH FIRST
// Grep(pattern="ArticleService", include="*.swift")
// 2. READ EXISTING FILES  
// Read(file_path="ArticleService.swift")
// 3. EXTEND EXISTING FUNCTIONALITY
// Edit existing service instead of creating new one
```

## üßπ DEBT PREVENTION WORKFLOW

### Before Creating ANY New Swift File:
1. **üîç Search First** - Use Grep/Glob to find existing implementations
2. **üìã Analyze Existing** - Read and understand current patterns
3. **ü§î Decision Tree**: Can extend existing? ‚Üí DO IT | Must create new? ‚Üí Document why
4. **‚úÖ Follow iOS Patterns** - Use established iOS and Swift patterns
5. **üìà Validate** - Ensure no duplication or technical debt

### üì± iOS-Specific Considerations:
- Follow SwiftUI and UIKit best practices
- Maintain proper MVVM separation
- Use Swift's type system effectively
- Follow iOS Human Interface Guidelines
- Ensure proper memory management

---

**‚ö†Ô∏è Prevention is better than consolidation - build clean from the start.**  
**üéØ Focus on single source of truth and extending existing functionality.**  
**üìà Each task should maintain clean architecture and prevent technical debt.**
**üì± Always consider iOS platform conventions and user experience.**

---

üéØ **Template by Chang Ho Chien | HC AI Ë™™‰∫∫Ë©±channel | v1.0.0**  
üì∫ **Tutorial**: https://youtu.be/8Q1bRZaHH24