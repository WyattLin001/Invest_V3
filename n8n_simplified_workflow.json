{
  "name": "è‚¡åœˆAIæŠ•è³‡æ–‡ç« è‡ªå‹•ç”Ÿæˆ_ç°¡åŒ–ç‰ˆ",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "days",
              "value": 1
            }
          ]
        },
        "triggerAtHour": 7,
        "triggerAtMinute": 0
      },
      "name": "æ¯æ—¥è§¸ç™¼",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.1,
      "position": [240, 300],
      "id": "trigger-node"
    },
    {
      "parameters": {
        "resource": "feedItems",
        "operation": "getAll",
        "url": "https://news.cnyes.com/rss/tw",
        "limit": 3,
        "options": {}
      },
      "name": "ç²å–æ–°è",
      "type": "n8n-nodes-base.rssFeedRead",
      "typeVersion": 1,
      "position": [460, 300],
      "id": "rss-node"
    },
    {
      "parameters": {
        "functionCode": "// ç°¡åŒ–çš„æ–°èæ•´ç†\nconst items = $input.all();\nlet newsContent = \"ä»Šæ—¥æŠ•è³‡æ–°èæ‘˜è¦ï¼š\\n\\n\";\n\nitems.forEach((item, index) => {\n  const news = item.json;\n  newsContent += `${index + 1}. ${news.title}\\næ‘˜è¦: ${(news.contentSnippet || news.description || '').substring(0, 200)}\\n\\n`;\n});\n\nreturn [{\n  json: {\n    newsContent: newsContent,\n    newsCount: items.length,\n    timestamp: new Date().toISOString()\n  }\n}];"
      },
      "name": "æ•´ç†æ–°è",
      "type": "n8n-nodes-base.function",
      "typeVersion": 2,
      "position": [680, 300],
      "id": "process-news"
    },
    {
      "parameters": {
        "resource": "text",
        "operation": "message",
        "model": "gpt-4o-mini",
        "options": {
          "temperature": 0.7,
          "maxTokens": 1200
        },
        "prompt": "ä½ æ˜¯å°ˆæ¥­æŠ•è³‡åˆ†æå¸«ã€‚åŸºæ–¼ä»¥ä¸‹æ–°èï¼Œæ’°å¯«ä¸€ç¯‡æŠ•è³‡åˆ†ææ–‡ç« ï¼š\n\n{{ $json.newsContent }}\n\nè«‹æŒ‰æ­¤æ ¼å¼æ’°å¯«ï¼š\n\n# [å¸å¼•äººçš„æ¨™é¡Œ]\n\n## å¸‚å ´æ¦‚æ³\n[ç•¶å‰å¸‚å ´åˆ†æ]\n\n## é‡é»é—œæ³¨\n[å€¼å¾—æ³¨æ„çš„é‡é»]\n\n## æŠ•è³‡è§€é»\n[å®¢è§€æŠ•è³‡è§€é»ï¼Œé¿å…ç›´æ¥å»ºè­°]\n\n## é¢¨éšªæé†’\n**é‡è¦è²æ˜ï¼šæœ¬æ–‡åƒ…ä¾›åƒè€ƒï¼ŒæŠ•è³‡æœ‰é¢¨éšªï¼Œè«‹è¬¹æ…è©•ä¼°ã€‚**\n\nè¦æ±‚ï¼š\n- èªèª¿å°ˆæ¥­å®¢è§€\n- 800-1000å­—\n- ç¹é«”ä¸­æ–‡\n- å¿…é ˆåŒ…å«é¢¨éšªè­¦ç¤º\n- é¿å…ç›´æ¥æŠ•è³‡å»ºè­°"
      },
      "name": "AIç”Ÿæˆæ–‡ç« ",
      "type": "n8n-nodes-base.openAi",
      "typeVersion": 1,
      "position": [900, 300],
      "credentials": {
        "openAiApi": {
          "id": "openai_credentials",
          "name": "OpenAI API"
        }
      },
      "id": "ai-generate"
    },
    {
      "parameters": {
        "functionCode": "// ç°¡åŒ–çš„æ–‡ç« è™•ç†\nconst aiContent = $json.message.content;\nconst lines = aiContent.split('\\n');\n\n// æå–æ¨™é¡Œ\nlet title = \"AIå¸‚å ´åˆ†æ - \" + new Date().toLocaleDateString('zh-TW');\nfor (let line of lines) {\n  if (line.startsWith('# ')) {\n    title = line.replace('# ', '').trim();\n    break;\n  }\n}\n\n// ç”Ÿæˆæ‘˜è¦\nconst summary = aiContent.replace(/#{1,6}\\s/g, '').substring(0, 150) + \"...\";\n\n// åŸºæœ¬é—œéµå­—\nconst keywords = [\"AIåˆ†æ\", \"æŠ•è³‡\", \"å¸‚å ´\", \"é¢¨éšªç®¡ç†\"];\n\nreturn [{\n  json: {\n    title: title,\n    content: aiContent,\n    summary: summary,\n    keywords: keywords,\n    word_count: aiContent.length,\n    read_time: Math.ceil(aiContent.length / 300) + \" åˆ†é˜\",\n    created_at: new Date().toISOString()\n  }\n}];"
      },
      "name": "è™•ç†æ–‡ç« ",
      "type": "n8n-nodes-base.function",
      "typeVersion": 2,
      "position": [1120, 300],
      "id": "process-article"
    },
    {
      "parameters": {
        "schema": "public",
        "table": "articles",
        "operation": "insert",
        "records": [
          {
            "title": "={{ $json.title }}",
            "author": "AI æŠ•è³‡åˆ†æå¸«",
            "author_id": "{{ $env.AI_AUTHOR_ID }}",
            "summary": "={{ $json.summary }}",
            "full_content": "={{ $json.content }}",
            "body_md": "={{ $json.content }}",
            "category": "æ¯æ—¥å¸‚å ´åˆ†æ",
            "read_time": "={{ $json.read_time }}",
            "is_free": false,
            "status": "draft",
            "source": "ai",
            "keywords": "={{ $json.keywords }}",
            "likes_count": 0,
            "comments_count": 0,
            "shares_count": 0
          }
        ],
        "options": {
          "returnFields": "id,title,created_at"
        }
      },
      "name": "ä¿å­˜æ–‡ç« ",
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [1340, 300],
      "credentials": {
        "supabaseApi": {
          "id": "supabase_credentials",
          "name": "Supabase API"
        }
      },
      "id": "save-article"
    },
    {
      "parameters": {
        "channel": "#è‚¡åœˆ-å…§å®¹å¯©æ ¸",
        "text": "ğŸ¤– AI æŠ•è³‡åˆ†ææ–‡ç« å·²ç”Ÿæˆï¼Œè«‹å¯©æ ¸ï¼š",
        "blocks": [
          {
            "type": "section",
            "text": {
              "type": "mrkdwn",
              "text": "*ğŸ“ æ–°çš„ AI æŠ•è³‡åˆ†æå¾…å¯©æ ¸*\n\n*æ¨™é¡Œï¼š* {{ $('è™•ç†æ–‡ç« ').json.title }}\n*å­—æ•¸ï¼š* {{ $('è™•ç†æ–‡ç« ').json.word_count }} å­—\n*é–±è®€æ™‚é–“ï¼š* {{ $('è™•ç†æ–‡ç« ').json.read_time }}\n*æ–‡ç«  IDï¼š* {{ $('ä¿å­˜æ–‡ç« ').json.id }}"
            }
          },
          {
            "type": "section",
            "text": {
              "type": "mrkdwn",
              "text": "*æ‘˜è¦ï¼š*\n{{ $('è™•ç†æ–‡ç« ').json.summary }}"
            }
          },
          {
            "type": "actions",
            "elements": [
              {
                "type": "button",
                "text": {
                  "type": "plain_text",
                  "text": "âœ… é€šéç™¼å¸ƒ"
                },
                "style": "primary",
                "value": "approve_{{ $('ä¿å­˜æ–‡ç« ').json.id }}",
                "action_id": "approve_article"
              },
              {
                "type": "button",
                "text": {
                  "type": "plain_text",
                  "text": "âŒ æ‹’çµ•ç™¼å¸ƒ"
                },
                "style": "danger",
                "value": "reject_{{ $('ä¿å­˜æ–‡ç« ').json.id }}",
                "action_id": "reject_article"
              },
              {
                "type": "button",
                "text": {
                  "type": "plain_text",
                  "text": "ğŸ“ éœ€è¦ä¿®æ”¹"
                },
                "value": "revise_{{ $('ä¿å­˜æ–‡ç« ').json.id }}",
                "action_id": "revise_article"
              }
            ]
          }
        ],
        "otherOptions": {
          "includeLinkToWorkflow": false
        }
      },
      "name": "Slackå¯©æ ¸é€šçŸ¥",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 1,
      "position": [1560, 300],
      "credentials": {
        "slackApi": {
          "id": "slack_credentials",
          "name": "Slack API"
        }
      },
      "id": "slack-notify"
    }
  ],
  "connections": {
    "æ¯æ—¥è§¸ç™¼": {
      "main": [
        [
          {
            "node": "ç²å–æ–°è",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ç²å–æ–°è": {
      "main": [
        [
          {
            "node": "æ•´ç†æ–°è",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ•´ç†æ–°è": {
      "main": [
        [
          {
            "node": "AIç”Ÿæˆæ–‡ç« ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AIç”Ÿæˆæ–‡ç« ": {
      "main": [
        [
          {
            "node": "è™•ç†æ–‡ç« ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è™•ç†æ–‡ç« ": {
      "main": [
        [
          {
            "node": "ä¿å­˜æ–‡ç« ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ä¿å­˜æ–‡ç« ": {
      "main": [
        [
          {
            "node": "Slackå¯©æ ¸é€šçŸ¥",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "settings": {
    "timezone": "Asia/Taipei",
    "saveManualExecutions": true,
    "callerPolicy": "workflowsFromSameOwner"
  },
  "staticData": null,
  "tags": [
    {
      "createdAt": "2025-08-01T08:00:00.000Z",
      "updatedAt": "2025-08-01T08:00:00.000Z",
      "id": "ai-automation",
      "name": "AIè‡ªå‹•åŒ–"
    }
  ],
  "triggerCount": 0,
  "updatedAt": "2025-08-01T08:00:00.000Z",
  "versionId": "simplified-1.0"
}